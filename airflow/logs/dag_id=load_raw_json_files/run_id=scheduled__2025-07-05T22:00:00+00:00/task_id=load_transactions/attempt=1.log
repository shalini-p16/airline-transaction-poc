{"timestamp":"2025-07-05T22:11:02.993648","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-05T22:11:02.993864","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/load_raw_data.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-05T22:11:03.125001","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-07-05T22:11:03.125277","level":"warning","event":"empty cryptography key - values will not be stored encrypted.","logger":"airflow.models.crypto"}
{"timestamp":"2025-07-05T22:11:03.125564","level":"info","event":"Connection Retrieved 'minio_conn'","logger":"airflow.hooks.base"}
{"timestamp":"2025-07-05T22:11:03.125696","level":"info","event":"AWS Connection (conn_id='minio_conn', conn_type='aws') credentials retrieved from login and password.","logger":"airflow.providers.amazon.aws.utils.connection_wrapper.AwsConnectionWrapper"}
{"timestamp":"2025-07-05T22:11:03.403098","level":"info","event":"Loading JSON file from MinIO: transactions.json","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-05T22:11:03.403241","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-07-05T22:11:03.403446","level":"info","event":"Connection Retrieved 'minio_conn'","logger":"airflow.hooks.base"}
{"timestamp":"2025-07-05T22:11:03.403535","level":"info","event":"AWS Connection (conn_id='minio_conn', conn_type='aws') credentials retrieved from login and password.","logger":"airflow.providers.amazon.aws.utils.connection_wrapper.AwsConnectionWrapper"}
{"timestamp":"2025-07-05T22:11:04.495789","level":"info","event":"Read 100000 rows and 7 columns from JSON.","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-05T22:11:05.479112","level":"info","event":"Auto-converted 'TransactionDateUTC' to datetime","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-05T22:11:05.648823","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-07-05T22:11:05.649140","level":"warning","event":"Skipping masking for a secret as it's too short (<5 chars)","logger":"airflow.sdk.execution_time.secrets_masker"}
{"timestamp":"2025-07-05T22:11:05.649198","level":"info","event":"Connection Retrieved 'clickhouse_conn'","logger":"airflow.hooks.base"}
{"timestamp":"2025-07-05T22:11:05.649283","level":"info","event":"Dropping existing table default.transactions (if any)...","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-05T22:11:05.651482","level":"info","event":"Creating table default.transactions with schema: {'UniqueId': 'Nullable(String)', 'TransactionDateUTC': 'Nullable(DateTime64(3))', 'Itinerary': 'Nullable(String)', 'OriginAirportCode': 'Nullable(String)', 'DestinationAirportCode': 'Nullable(String)', 'OneWayOrReturn': 'Nullable(String)', 'Segment': 'Nullable(String)'}","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-05T22:11:06.490510","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"AttributeError","exc_value":"'list' object has no attribute 'encode'","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/opt/airflow/dags/operators/minio_to_clickhouse/MinIOToClickHouseOperator.py","lineno":147,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":376,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":607,"name":"process_insert_query"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":660,"name":"send_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/connection.py","lineno":688,"name":"send_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/streams/native.py","lineno":48,"name":"write"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/columns/service.py","lineno":167,"name":"write_column"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/columns/base.py","lineno":145,"name":"write_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/columns/base.py","lineno":149,"name":"_write_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/columns/stringcolumn.py","lineno":18,"name":"write_items"},{"filename":"/opt/airflow/clickhouse_driver/bufferedwriter.pyx","lineno":54,"name":"clickhouse_driver.bufferedwriter.BufferedWriter.write_strings"}]}]}
