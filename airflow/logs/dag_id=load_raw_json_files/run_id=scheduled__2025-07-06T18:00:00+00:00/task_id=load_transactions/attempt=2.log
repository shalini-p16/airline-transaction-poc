{"timestamp":"2025-07-06T18:21:45.738330","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-07-06T18:21:45.738839","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/load_raw_data.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-07-06T18:21:45.834301","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-07-06T18:21:45.834855","level":"warning","event":"empty cryptography key - values will not be stored encrypted.","logger":"airflow.models.crypto"}
{"timestamp":"2025-07-06T18:21:45.835271","level":"info","event":"Connection Retrieved 'minio_conn'","logger":"airflow.hooks.base"}
{"timestamp":"2025-07-06T18:21:45.835397","level":"info","event":"AWS Connection (conn_id='minio_conn', conn_type='aws') credentials retrieved from login and password.","logger":"airflow.providers.amazon.aws.utils.connection_wrapper.AwsConnectionWrapper"}
{"timestamp":"2025-07-06T18:21:46.048323","level":"info","event":"Loading JSON file from MinIO: transactions.json","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-06T18:21:46.048470","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-07-06T18:21:46.048651","level":"info","event":"Connection Retrieved 'minio_conn'","logger":"airflow.hooks.base"}
{"timestamp":"2025-07-06T18:21:46.048746","level":"info","event":"AWS Connection (conn_id='minio_conn', conn_type='aws') credentials retrieved from login and password.","logger":"airflow.providers.amazon.aws.utils.connection_wrapper.AwsConnectionWrapper"}
{"timestamp":"2025-07-06T18:21:47.359582","level":"info","event":"Read 100000 rows and 7 columns from JSON.","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-06T18:21:47.536239","level":"info","event":"Removed 'UTC' from datetime column: TransactionDateUTC","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-06T18:21:48.264945","level":"info","event":"Auto-converted 'TransactionDateUTC' to datetime","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-06T18:21:48.790316","level":"info","event":"Secrets backends loaded for worker","count":1,"backend_classes":["EnvironmentVariablesBackend"],"logger":"supervisor"}
{"timestamp":"2025-07-06T18:21:48.790666","level":"warning","event":"Skipping masking for a secret as it's too short (<5 chars)","logger":"airflow.sdk.execution_time.secrets_masker"}
{"timestamp":"2025-07-06T18:21:48.790730","level":"info","event":"Connection Retrieved 'clickhouse_conn'","logger":"airflow.hooks.base"}
{"timestamp":"2025-07-06T18:21:48.790816","level":"info","event":"Dropping existing table default.transactions (if any)...","logger":"airflow.task.operators.operators.minio_to_clickhouse.MinIOToClickHouseOperator.MinIOToClickHouseOperator"}
{"timestamp":"2025-07-06T18:21:48.791864","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"UnexpectedPacketFromServerError","exc_value":"Code: 102. Unexpected packet from server clickhouse:8123 (expected Hello or Exception, got Unknown packet)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":838,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1130,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":408,"name":"wrapper"},{"filename":"/opt/airflow/dags/operators/minio_to_clickhouse/MinIOToClickHouseOperator.py","lineno":144,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":370,"name":"execute"},{"filename":"/usr/local/lib/python3.12/contextlib.py","lineno":137,"name":"__enter__"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":313,"name":"disconnect_on_error"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/client.py","lineno":300,"name":"establish_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/connection.py","lineno":258,"name":"force_connect"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/connection.py","lineno":399,"name":"connect"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/connection.py","lineno":343,"name":"_init_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/clickhouse_driver/connection.py","lineno":534,"name":"receive_hello"}]}]}
